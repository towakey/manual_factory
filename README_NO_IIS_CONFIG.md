# Manual Factory - IIS設定変更不要版

## 状況
- IISでPythonは使用できる
- IISの設定変更はできない
- 別途サーバープロセスは立てられない

---

## ✅ 解決策

### 方法1: CGI方式（推奨）

#### 前提条件
- IISでCGI実行が有効になっている

#### 使用方法
```
http://localhost/manual_factory/index.py
```
または
```
http://localhost/manual_factory/app_cgi.py
```

#### 確認
ブラウザでアクセスして、エラーが出るか確認してください。

**エラーが出る場合:**
- 「500 Internal Server Error」→ IISでCGI実行が無効
- 「404 Not Found」→ パスが間違っている
- ダウンロードが始まる → CGIとして認識されていない

---

### 方法2: ポータブルサーバー（使用時のみ起動）

#### 使い方
1. `start.bat`をダブルクリック
2. 自動的にブラウザが開く（または手動で`http://localhost:8000/`にアクセス）
3. 使用後、ウィンドウを閉じる

#### 特徴
- IIS不要
- 設定変更不要
- 使用時のみ起動
- Python標準ライブラリのみ

```cmd
start.bat
```

---

### 方法3: Pythonスクリプトとして直接実行

#### ローカルテスト用
```cmd
cd c:\xampp\htdocs\manual_factory
python server_wsgi.py 8000
```

ブラウザで`http://localhost:8000/`にアクセス

使用後、`Ctrl+C`で停止

---

## 🎯 推奨フロー

### ステップ1: CGI方式を試す

1. ブラウザで以下にアクセス:
```
http://localhost/manual_factory/index.py
```

2. 結果を確認:
   - ✅ ログイン画面が表示 → **成功！設定不要で使えます**
   - ❌ エラー表示 → 次のステップへ

### ステップ2: ポータブルサーバーを使用

1. `start.bat`をダブルクリック
2. `http://localhost:8000/`にアクセス
3. 使用後、ウィンドウを閉じる

---

## 📋 各方法の比較

| 方法 | IIS設定 | サーバープロセス | 起動方法 | 推奨度 |
|------|---------|----------------|---------|--------|
| CGI | 不要 | 不要 | 自動 | ⭐⭐⭐⭐⭐ |
| ポータブル | 不要 | 手動起動 | start.bat | ⭐⭐⭐⭐ |
| 直接実行 | 不要 | 手動起動 | コマンド | ⭐⭐⭐ |

---

## 🔧 トラブルシューティング

### CGI方式でエラーが出る

**エラー: 500 Internal Server Error**
```
原因: IISでCGI実行が無効
解決: ポータブルサーバーを使用
```

**エラー: Pythonファイルがダウンロードされる**
```
原因: .pyファイルがCGIとして認識されていない
解決: index.pyをindex.cgiにリネーム、またはポータブルサーバーを使用
```

### ポータブルサーバーが起動しない

**エラー: Pythonが見つからない**
```cmd
# Pythonパスを確認
where python
python --version
```

**エラー: ポートが使用中**
```cmd
# 別のポートを使用
python server_wsgi.py 3000
```

---

## 💡 最終的な推奨

### あなたの状況に最適な方法

**優先順位1: CGI方式**
- まず`http://localhost/manual_factory/index.py`にアクセスしてみる
- 動作すれば、これが最もシンプル

**優先順位2: ポータブルサーバー**
- CGIが動作しない場合
- `start.bat`で簡単起動
- 使用後は終了

**優先順位3: 代替案を検討**
- 管理者に相談してIIS CGI実行を有効にしてもらう
- または、開発環境で使用

---

## 🚀 クイックテスト

### テスト1: CGI方式
```
http://localhost/manual_factory/index.py
```
結果: _______________

### テスト2: ポータブルサーバー
```cmd
start.bat
```
結果: _______________

---

## 結論

**IIS設定を変更できなくても、以下の方法で使用可能です:**

1. ✅ **CGI方式** - IISでCGI実行が有効なら設定不要
2. ✅ **ポータブルサーバー** - 使用時のみ`start.bat`で起動
3. ✅ **直接実行** - コマンドラインで起動

**まず`http://localhost/manual_factory/index.py`にアクセスして、動作するか確認してください！**
